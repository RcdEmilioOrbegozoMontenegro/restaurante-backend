import "dotenv/config";
import { pool } from "../src/lib/db.js";

await pool.query(`
  ALTER TABLE users
    ADD COLUMN IF NOT EXISTS employee_no INT GENERATED BY DEFAULT AS IDENTITY UNIQUE,
    ADD COLUMN IF NOT EXISTS full_name TEXT NOT NULL DEFAULT '',
    ADD COLUMN IF NOT EXISTS phone TEXT,
    ADD COLUMN IF NOT EXISTS active BOOLEAN NOT NULL DEFAULT true;
  -- Si tu email aún no es único, descomenta:
  -- DO $$
  -- BEGIN
  --   IF NOT EXISTS (
  --     SELECT 1 FROM pg_indexes WHERE indexname = 'users_email_key'
  --   ) THEN
  --     ALTER TABLE users ADD CONSTRAINT users_email_key UNIQUE (email);
  --   END IF;
  -- END $$;
`);
console.log("Migración 002 aplicada ✅");
process.exit(0);
